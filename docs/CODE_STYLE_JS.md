# CODE_STYLE_JS.md
Стандарты JavaScript-кода для SM Codex Portal

Документ определяет правила написания кода во всех модулях проекта, чтобы проект оставался чистым, масштабируемым и легко поддерживаемым.

---

# 1. Принципы

1. **Vanilla JS Only**  
   Не используются фреймворки и сторонние библиотеки.

2. **ES Modules**  
   Все файлы — модульные (`import/export`).

3. **Single Responsibility**  
   Каждая функция и каждый модуль выполняют одну задачу.

4. **Простота важнее магии**  
   Лёгкость чтения важнее попыток “сэкономить одну строку”.

---

# 2. Именование

## 2.1. Переменные
- `camelCase`
- должны описывать смысл:
  - `factHours`
  - `teamBonus`
  - `userGrade`
  - `quizData`

❌ Плохой пример:  
`a`, `tmp`, `arr2`, `x1`, `calcData`

---

## 2.2. Функции
Имя = действие + объект:

- `initCalculator()`
- `bindEvents()`
- `loadQuizData()`
- `renderSection()`

---

## 2.3. Модули
Каждый модуль — в своей папке:

```

/js/modules/support/main.js
/js/modules/sales/main.js

````

---

# 3. Структура JavaScript файла

```js
// 1. Импорты
import { formatMoney } from "/sm/js/calculators/core.js";

// 2. Константы
const DEFAULT_RATE = 0.13;

// 3. Основные функции
function recalc() { … }

function bindEvents() { … }

// 4. Экспорт модуля или функции
export default { init, destroy };
````

---

# 4. Работа с DOM

## 4.1. Доступ только по селекторам

```js
const root = container.querySelector("#l1-root");
```

Запрещено:

* делать запросы к документу глубоко внутри логики,
* создавать элементы хаотично.

## 4.2. Рендер

Разметка создаётся:

* либо через `template strings`,
* либо заранее в HTML, затем скрывается/показывается.

❌ Нельзя генерировать HTML через конкатенацию.

---

# 5. Комментарии

Используется формат:

```js
/**
 * Рассчитывает финальную премию L2
 */
function calcL2Bonus() {}
```

Запрещено:

* избыточные комментарии: `// увеличиваем на 1`
* комментарии о очевидных вещах.

---

# 6. Импорты

Правильно:

```js
import { initL1Calculator } from "/sm/js/calculators/l1.js";
```

Неправильно:

```js
import utils from "../../js/helpers.js";  // незаметно ломает архитектуру
```

---

# 7. Ошибки

Все вычисления проходят через:

* `parseNumber()`
* `formatMoney()`

Это защищает от:

* NaN,
* некорректных значений,
* неверных округлений.

---

# 8. Тестирование JS

Каждое изменение требует:

1. Проверить консоль DevTools
2. Проверить открытие всех модальных окон
3. Проверить работу калькуляторов
4. Проверить переключение секций subnav
5. Проверить sticky-поведение

---

# 9. Антипаттерны

❌ Inline JS
❌ Глобальные функции
❌ Дублирование расчётов
❌ Логика внутри шаблонов HTML
❌ Логика внутри event listeners

---

# 10. Рекомендации

* Функции ≤ 25 строк
* Модуль ≤ 500 строк
* Логика отделена от DOM
* Имена должны быть интуитивными
